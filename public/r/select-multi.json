{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "select-multi",
  "title": "Select Multi",
  "description": "A multi-select with badges",
  "registryDependencies": [
    "badge",
    "button",
    "command",
    "popover",
    "separator"
  ],
  "files": [
    {
      "path": "registry/helisa/ui/select-multi.tsx",
      "content": "\"use client\";\r\n\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Command,\r\n  CommandEmpty,\r\n  CommandGroup,\r\n  CommandInput,\r\n  CommandItem,\r\n  CommandList,\r\n} from \"@/components/ui/command\";\r\nimport {\r\n  Popover,\r\n  PopoverContent,\r\n  PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nimport { Check, PlusCircle } from \"lucide-react\";\r\nimport * as React from \"react\";\r\n\r\ninterface SelectMultiProps\r\n  extends Omit<\r\n    React.ComponentPropsWithoutRef<typeof CommandInput>,\r\n    \"value\" | \"onChange\"\r\n  > {\r\n  title: string;\r\n  options: {\r\n    label: string;\r\n    value: string;\r\n    icon?: React.ComponentType<{ className?: string }>;\r\n  }[];\r\n  value?: string[];\r\n  onChange?: (value: string[]) => void;\r\n  placeholder?: string;\r\n}\r\n\r\nexport const SelectMulti = ({\r\n  title,\r\n  options,\r\n  value = [],\r\n  onChange,\r\n  placeholder,\r\n  ...props\r\n}: SelectMultiProps) => {\r\n  const [selectedValues, setSelectedValues] = React.useState<Set<string>>(\r\n    new Set(value),\r\n  );\r\n\r\n  // Add this useEffect to sync internal state with props\r\n  React.useEffect(() => {\r\n    setSelectedValues(new Set(value));\r\n  }, [value]);\r\n\r\n  const handleSelect = (currentValue: string) => {\r\n    const newSelectedValues = new Set(selectedValues);\r\n\r\n    if (newSelectedValues.has(currentValue)) {\r\n      newSelectedValues.delete(currentValue);\r\n    } else {\r\n      newSelectedValues.add(currentValue);\r\n    }\r\n\r\n    setSelectedValues(newSelectedValues);\r\n    onChange?.(Array.from(newSelectedValues));\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setSelectedValues(new Set());\r\n    onChange?.([]);\r\n  };\r\n\r\n  return (\r\n    <Popover>\r\n      <PopoverTrigger asChild>\r\n        <Button\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n          className=\"h-8 border-dashed select-none\"\r\n          aria-label={`Select ${title}`}\r\n          disabled={props.disabled}\r\n        >\r\n          <PlusCircle className=\"mr-2\" />\r\n          {title}\r\n          {selectedValues.size > 0 && (\r\n            <>\r\n              <Separator orientation=\"vertical\" className=\"mx-2 h-4\" />\r\n              <Badge\r\n                variant=\"secondary\"\r\n                className=\"rounded-sm px-1 font-normal lg:hidden\"\r\n              >\r\n                {selectedValues.size}\r\n              </Badge>\r\n              <div className=\"hidden space-x-1 lg:flex\">\r\n                {selectedValues.size > 2 ? (\r\n                  <Badge\r\n                    variant=\"secondary\"\r\n                    className=\"rounded-sm px-1 font-normal\"\r\n                  >\r\n                    {selectedValues.size} seleccionados\r\n                  </Badge>\r\n                ) : (\r\n                  options\r\n                    .filter((option) => selectedValues.has(option.value))\r\n                    .map((option) => (\r\n                      <Badge\r\n                        variant=\"secondary\"\r\n                        key={option.value}\r\n                        className=\"rounded-sm px-1 font-normal\"\r\n                      >\r\n                        {option.label}\r\n                      </Badge>\r\n                    ))\r\n                )}\r\n              </div>\r\n            </>\r\n          )}\r\n        </Button>\r\n      </PopoverTrigger>\r\n      <PopoverContent\r\n        className=\"w-[var(--radix-popover-trigger-width)] p-0\"\r\n        align=\"start\"\r\n      >\r\n        <Command>\r\n          <CommandInput placeholder={placeholder ?? title} {...props} />\r\n          <CommandList>\r\n            <CommandEmpty>Sin resultados.</CommandEmpty>\r\n            <CommandGroup>\r\n              {options.map((option) => {\r\n                const isSelected = selectedValues.has(option.value);\r\n                return (\r\n                  <CommandItem\r\n                    key={option.value}\r\n                    onSelect={() => handleSelect(option.value)}\r\n                  >\r\n                    <div\r\n                      className={cn(\r\n                        \"mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary\",\r\n                        isSelected\r\n                          ? \"bg-primary text-primary-foreground\"\r\n                          : \"opacity-50 [&_svg]:invisible\",\r\n                      )}\r\n                    >\r\n                      <Check className=\"text-primary-foreground\" />\r\n                    </div>\r\n                    {option.icon && (\r\n                      <option.icon className=\"mr-2 h-4 w-4 text-muted-foreground\" />\r\n                    )}\r\n                    <span>{option.label}</span>\r\n                  </CommandItem>\r\n                );\r\n              })}\r\n            </CommandGroup>\r\n          </CommandList>\r\n        </Command>\r\n        {selectedValues.size > 0 && (\r\n          <>\r\n            <Separator />\r\n            <Button\r\n              variant=\"ghost\"\r\n              className=\"w-full rounded-none rounded-b-md\"\r\n              onClick={handleClear}\r\n            >\r\n              Limpiar\r\n            </Button>\r\n          </>\r\n        )}\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n};\r\n",
      "type": "registry:ui",
      "target": "components/helisa/ui/select-multi.tsx"
    }
  ],
  "type": "registry:ui"
}
