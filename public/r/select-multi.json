{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "select-multi",
  "type": "registry:ui",
  "title": "Select Multi",
  "description": "A multi-select with badges",
  "registryDependencies": [
    "badge",
    "button",
    "command",
    "popover",
    "separator"
  ],
  "files": [
    {
      "path": "registry/helisa/ui/select-multi.tsx",
      "content": "\"use client\";\n\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n  CommandSeparator,\n} from \"@/components/ui/command\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { cn } from \"@/lib/utils\";\n\nimport { Check, PlusCircle } from \"lucide-react\";\nimport * as React from \"react\";\n\ninterface SelectMultiProps {\n  title: string;\n  options: {\n    label: string;\n    value: string;\n    icon?: React.ComponentType<{ className?: string }>;\n  }[];\n  value?: string[];\n  onChange?: (value: string[]) => void;\n  placeholder?: string;\n}\n\nexport const SelectMulti = ({\n  title,\n  options,\n  value = [],\n  onChange,\n  placeholder,\n}: SelectMultiProps) => {\n  const [selectedValues, setSelectedValues] = React.useState<Set<string>>(\n    new Set(value),\n  );\n\n  // Add this useEffect to sync internal state with props\n  React.useEffect(() => {\n    setSelectedValues(new Set(value));\n  }, [value]);\n\n  const handleSelect = (currentValue: string) => {\n    const newSelectedValues = new Set(selectedValues);\n\n    if (newSelectedValues.has(currentValue)) {\n      newSelectedValues.delete(currentValue);\n    } else {\n      newSelectedValues.add(currentValue);\n    }\n\n    setSelectedValues(newSelectedValues);\n    onChange?.(Array.from(newSelectedValues));\n  };\n\n  const handleClear = () => {\n    setSelectedValues(new Set());\n    onChange?.([]);\n  };\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"h-8 border-dashed select-none\"\n          aria-label={`Select ${title}`}\n        >\n          <PlusCircle className=\"mr-2\" />\n          {title}\n          {selectedValues.size > 0 && (\n            <>\n              <Separator orientation=\"vertical\" className=\"mx-2 h-4\" />\n              <Badge\n                variant=\"secondary\"\n                className=\"rounded-sm px-1 font-normal lg:hidden\"\n              >\n                {selectedValues.size}\n              </Badge>\n              <div className=\"hidden space-x-1 lg:flex\">\n                {selectedValues.size > 2 ? (\n                  <Badge\n                    variant=\"secondary\"\n                    className=\"rounded-sm px-1 font-normal\"\n                  >\n                    {selectedValues.size} seleccionados\n                  </Badge>\n                ) : (\n                  options\n                    .filter((option) => selectedValues.has(option.value))\n                    .map((option) => (\n                      <Badge\n                        variant=\"secondary\"\n                        key={option.value}\n                        className=\"rounded-sm px-1 font-normal\"\n                      >\n                        {option.label}\n                      </Badge>\n                    ))\n                )}\n              </div>\n            </>\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-[200px] p-0\" align=\"start\">\n        <Command>\n          <CommandInput placeholder={placeholder ?? title} />\n          <CommandList>\n            <CommandEmpty>Sin resultados.</CommandEmpty>\n            <CommandGroup>\n              {options.map((option) => {\n                const isSelected = selectedValues.has(option.value);\n                return (\n                  <CommandItem\n                    key={option.value}\n                    onSelect={() => handleSelect(option.value)}\n                  >\n                    <div\n                      className={cn(\n                        \"mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary\",\n                        isSelected\n                          ? \"bg-primary text-primary-foreground\"\n                          : \"opacity-50 [&_svg]:invisible\",\n                      )}\n                    >\n                      <Check />\n                    </div>\n                    {option.icon && (\n                      <option.icon className=\"mr-2 h-4 w-4 text-muted-foreground\" />\n                    )}\n                    <span>{option.label}</span>\n                  </CommandItem>\n                );\n              })}\n            </CommandGroup>\n            {selectedValues.size > 0 && (\n              <>\n                <CommandSeparator />\n                <CommandGroup>\n                  <CommandItem\n                    onSelect={handleClear}\n                    className=\"justify-center text-center\"\n                  >\n                    Limpiar selecci√≥n\n                  </CommandItem>\n                </CommandGroup>\n              </>\n            )}\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n};\n",
      "type": "registry:ui",
      "target": "components/helisa/ui/select-multi.tsx"
    }
  ]
}
