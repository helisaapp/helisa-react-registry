{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "date-utils",
  "type": "registry:lib",
  "title": "Date Utilities",
  "description": "A set of utility functions for date manipulation and formatting.",
  "dependencies": [
    "date-fns"
  ],
  "files": [
    {
      "path": "registry/helisa/lib/date-utils.ts",
      "content": "import {\n  addDays,\n  isAfter,\n  isBefore,\n  isEqual,\n  isValid,\n  parseISO,\n  startOfDay,\n} from \"date-fns\";\n\nfunction parseDate(date: string | Date | number): Date | null {\n  try {\n    let parsedDate: Date;\n\n    if (typeof date === \"string\") {\n      parsedDate =\n        date.includes(\"T\") || date.includes(\"-\")\n          ? parseISO(date)\n          : new Date(date);\n    } else if (typeof date === \"number\") {\n      parsedDate = new Date(date);\n    } else {\n      parsedDate = date;\n    }\n\n    return isValid(parsedDate) ? parsedDate : null;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Evalúa el estado de expiración de una fecha en relación con un número de días a partir de hoy.\n *\n * @param expirationDate Fecha de expiración\n * @param daysFromNow Número de días desde la fecha actual para considerar como \"por vencer\"\n * @param referenceDate Fecha de referencia (por defecto es hoy)\n * @returns ExpirationStatus: 'EXPIRED' | 'EXPIRING_SOON' | 'VALID_FUTURE' | 'INVALID_DATE'\n */\n\nexport function isExpiringWithinDays(\n  expirationDate: string | Date | number,\n  daysFromNow: number = 15,\n  referenceDate?: Date,\n): boolean {\n  if (!expirationDate) return false;\n\n  if (!Number.isInteger(daysFromNow) || daysFromNow < 0) {\n    throw new Error(\"daysFromNow must be a non-negative integer\");\n  }\n\n  const expiration = parseDate(expirationDate);\n  if (!expiration) return false;\n\n  const reference = referenceDate ? parseDate(referenceDate) : new Date();\n  if (!reference) return false;\n\n  const normalizedReference = startOfDay(reference);\n  const normalizedExpiration = startOfDay(expiration);\n  const limitDate = startOfDay(addDays(reference, daysFromNow));\n\n  return (\n    (isEqual(normalizedExpiration, normalizedReference) ||\n      isAfter(normalizedExpiration, normalizedReference)) &&\n    (isEqual(normalizedExpiration, limitDate) ||\n      isBefore(normalizedExpiration, limitDate))\n  );\n}\n\n// Reusable function to safely format dates to YYYY-MM-DD without timezone issues\nexport const formatDateSafely = (date: Date): string => {\n  if (!date) return \"\";\n\n  try {\n    // Extract just the date part (YYYY-MM-DD)\n    const datePart = date.toString().split(\"T\")[0];\n\n    // Create a new date from just the date part and format it\n    return datePart;\n  } catch (error) {\n    console.error(\"Error formatting date:\", error);\n    return \"\";\n  }\n};\n\n/**\n * Calculates the elapsed time from a date to now in readable format.\n *\n * @param date Reference date (can be string, Date or number)\n * @param referenceDate Current reference date (defaults to now)\n * @returns Formatted string like \"Hace X horas\" or \"Hace X días\"\n */\nexport const getTimeAgo = (\n  date: string | Date | number,\n  referenceDate?: Date,\n): string => {\n  const parsedDate = parseDate(date);\n  if (!parsedDate) return \"\";\n\n  const now = referenceDate || new Date();\n  const diffMs = now.getTime() - parsedDate.getTime();\n  const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n\n  if (diffHours < 24) {\n    return `Hace ${diffHours} ${diffHours === 1 ? \"hora\" : \"horas\"}`;\n  } else {\n    const diffDays = Math.floor(diffHours / 24);\n    return `Hace ${diffDays} ${diffDays === 1 ? \"día\" : \"días\"}`;\n  }\n};\n",
      "type": "registry:lib",
      "target": "lib/date-utils.ts"
    }
  ]
}